<!DOCTYPE html>
<html>
<head>
    <title>Mi Juego</title>
    <link rel="stylesheet" type="text/css" href="estilo_juego.css">
</head>
<body>
    
    <div class="image-container">
        <img src="ahorcado.png" class="left-aligned">
    </div>

    <div class="image-container2">
        <img src="ahorcado.png" class="left-aligned">
    </div>

    <div class="jugador-info">
        <h1 id="nombreJugador"></h1>
        <p id="puntosJugador">0 puntos</p>
    </div>

    <div id="pista" class="pista-container">
        <p>Pregunta: ¿inserta tu pregunta aqui?</p>
    </div>

    <div class="ahorcado-container">
        <div id="ahorcado"></div>
        <div class="guiones-container">
            <p id="guiones"></p>
        </div>
    </div>

    <div class="botones-letras">
        <button>A</button>
        <button>B</button>
        <button>C</button>
        <button>D</button>
        <button>E</button>
        <button>F</button>
        <button>G</button>
        <button>H</button>
        <button>I</button>
        <button>J</button>
        <button>K</button>
        <button>L</button>
        <button>M</button>
        <button>N</button>
        <button>Ñ</button>
        <button>O</button>
        <button>P</button>
        <button>Q</button>
        <button>R</button>
        <button>S</button>
        <button>T</button>
        <button>U</button>
        <button>V</button>
        <button>W</button>
        <button>X</button>
        <button>Y</button>
        <button>Z</button>
    </div>

    <section>
        <article>
            <p id="pregunta"></p>
        </article>
        <button id="siguientePregunta" class="siguiente-pregunta" onclick="siguientePregunta()">Pase a la siguiente pregunta</button>
    </section>

    <!-- <button id="siguientePregunta" class="siguiente-pregunta">Pase a la siguiente pregunta</button> -->

    <h2>{{ titulo }}</h2> <!-- Subtítulo agregado -->

    <script>
        // Obtener el nombre del jugador guardado en el almacenamiento local
        var nombreJugador = localStorage.getItem('nombreJugador');
        // Actualizar el contenido del elemento con el nombre del jugador
        document.getElementById('nombreJugador').innerText = nombreJugador;

        // Definir la cantidad de guiones iniciales
        var cantidadGuiones = 6;

        // Generar los guiones iniciales en base a la respuesta
        function generarGuiones(respuesta) {
            var guiones = '';

            for (var i = 0; i < respuesta.length; i++) {
                if (respuesta[i] === ' ') {
                    guiones += ' '; // Agregar espacio si el carácter es un espacio
                } else {
                    guiones += '_'; // Agregar guión si el carácter no es un espacio
                }
                guiones += ' '; // Agregar un espacio después de cada guión o espacio
            }

            return guiones.trim(); // Eliminar espacios en blanco adicionales al final
        }

        // Agregar evento de clic a los botones de letras
        var letras = document.querySelectorAll('.botones-letras button');
        letras.forEach(function(letra) {
            letra.addEventListener('click', function() {
                completarGuiones(this.innerText);
            });
        });

        let preguntas = [];
        let preguntaActual = 1;

        function mostrarPregunta() {
            const pregunta = preguntas[preguntaActual].pregunta;
            document.querySelector("#pista").textContent = pregunta;
            
            const respuesta = preguntas[preguntaActual].respuesta;
            const guiones = generarGuiones(respuesta);
            document.getElementById('guiones').innerText = guiones;
        }

        function completarGuiones(letra) {
            var guionesElement = document.getElementById('guiones');
            var contenido = guionesElement.innerText;
            var nuevoContenido = '';

            var respuesta = preguntas[preguntaActual].respuesta;

            for (var i = 0; i < respuesta.length; i++) {
                if (respuesta[i] === ' ') {
                    nuevoContenido += ' ';
                } else if (contenido[i * 2] === '_' && respuesta[i].toLowerCase() === letra.toLowerCase()) {
                    nuevoContenido += letra;
                } else {
                    nuevoContenido += contenido[i * 2];
                }
                nuevoContenido += ' ';
            }

            guionesElement.innerText = nuevoContenido;
        }

        function siguientePregunta() {
            preguntaActual++;
            if (preguntaActual < preguntas.length) {
                mostrarPregunta();
            } else {
                document.querySelector("#siguientePregunta").textContent = "¡Has respondido todas las preguntas!";
            }
        }

        function obtenerPreguntas() {
            fetch('http://localhost:3000/jugar')
                .then(response => response.json())
                .then(data => {
                    preguntas = data;
                    mostrarPregunta();
                })
                .catch(error => {
                    console.error(error);
                });
        }

        obtenerPreguntas();

    </script>
    <script src="index.js"></script>
</body>
</html>
